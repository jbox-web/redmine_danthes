{"name":"Redmine danthes","tagline":"A Redmine plugin which makes sending asynchronous notifications easy ;)","body":"## ![logo](https://raw.github.com/jbox-web/redmine_danthes/gh-pages/images/logo.png) Redmine d'Anthès Plugin\r\n\r\n### A Redmine plugin which makes sending asynchronous notifications easy ;)\r\n\r\nThis plugin allows straightforward integration of [d'Anthès](https://github.com/dotpromo/danthes) within Redmine.\r\n\r\n## Requirements\r\n\r\n* Ruby 2.0.x\r\n* a working [Redmine](http://www.redmine.org/) installation\r\n* a working Redis server\r\n\r\n## Installation\r\n\r\n    ## Before install the plugin, stop Redmine!\r\n\r\n    # Clone plugin\r\n    root# su - redmine\r\n    redmine$ cd REDMINE_ROOT/plugins\r\n    redmine$ git clone https://github.com/jbox-web/redmine_danthes.git\r\n\r\n    # Copy Danthes config file to Redmine config dir\r\n    redmine$ cd redmine_danthes/\r\n    redmine$ cp config/danthes*.yml ../../config/\r\n\r\n    # Copy ```danthes.ru``` Rack script to Redmine root dir\r\n    redmine$ cp danthes.ru ../../\r\n\r\n    # Install gems\r\n    redmine$ cd REDMINE_ROOT\r\n    redmine$ bundle install\r\n\r\n    ## After install the plugin, start Redmine!\r\n\r\n## Configuration\r\n\r\nYou **must** configure d'Anthès by editing ```config/danthes.yml``` file.\r\n\r\nYou will have to set a secret to secure your connection with Faye and the Redmine url (for instance http://redmine.example.net).\r\n\r\nYou **must** also configure your webserver to redirect Faye requests :\r\n\r\nNginx config :\r\n\r\nAdd this in ```server``` section :\r\n\r\n    location /faye {\r\n      access_log   /data/logs/nginx/faye.access.log;\r\n      error_log    /data/logs/nginx/faye.error.log;\r\n\r\n      proxy_pass http://127.0.0.1:9292;\r\n\r\n      proxy_http_version 1.1;\r\n\r\n      proxy_set_header Upgrade $http_upgrade;\r\n      proxy_set_header Connection $connection_upgrade;\r\n\r\n      proxy_set_header X-Real-IP  $remote_addr;\r\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n      proxy_set_header X-Forwarded-Proto https;\r\n      proxy_set_header Host $http_host;\r\n\r\n      gzip off;\r\n      expires off;\r\n\r\n      chunked_transfer_encoding off;\r\n      proxy_buffering           off;\r\n      proxy_cache               off;\r\n      proxy_redirect            off;\r\n      proxy_send_timeout        850000;\r\n      proxy_read_timeout        850000;\r\n      proxy_connect_timeout     850000;\r\n    }\r\n\r\nAdd this outside of ```server``` section :\r\n\r\n    map $http_upgrade $connection_upgrade {\r\n      default upgrade;\r\n      ''      close;\r\n    }\r\n\r\n## Start d'Anthès/Faye!\r\n\r\n    root# su - redmine\r\n    redmine$ cd REDMINE_ROOT\r\n    redmine$ rackup danthes.ru -s thin -E production\r\n\r\nYou're done!\r\n\r\nNow you may need to add your own notifications channels and events, see below!\r\n\r\n## Plugin developpers\r\n\r\nIf you want to integrate Faye async notifications in your plugin you need to register your own channels and events in your ```init.rb``` file : each channel can have many events. It may also have an optional ```target``` parameter which can be a string or a Proc.\r\n\r\n    ## it must be OUTSIDE of the Redmine::Plugin.register block\r\n\r\n    AsyncNotifications.register_channel :channel_test do\r\n      target Proc.new { User.current.login }\r\n      event  :event1\r\n      event  :event2\r\n      event  :event3\r\n    end\r\n\r\n    AsyncNotifications.register_channel :broadcast do\r\n      target 'broadcast'\r\n      event  :event1\r\n      event  :event2\r\n      event  :event3\r\n    end\r\n\r\nThe rest is handled by the plugin ;)\r\n\r\nTo check that it's working go in Redmine and load any page. Then edit with Firebug. At the bottom you should have something like that :\r\n\r\n    <div data-url=\"/my/notifications\" id=\"notifications\" style=\"display: none;\">\r\n      <script type=\"text/javascript\">\r\n        if (typeof Danthes != 'undefined') { Danthes.sign({\"server\":\"http://redmine.example.net/faye\",\"timestamp\":1427061870776,\"channel\":\"/channel_test/admin\",\"signature\":\"8416c90289dbdbd35130da4018d376b5469c1793\"}) }\r\n      </script>\r\n    </div>\r\n    <script>\r\n      $(document).ready(function() { setAsyncNotifications(); });\r\n    </script>\r\n\r\nYou should also see connections to Faye and errors if any.\r\n\r\nNote that if your browser or your connection don't support WebSockets it will fallback to long-polling mode automatically.\r\n\r\n## Copyrights & License\r\n\r\nRedmine d'Anthes is completely free and open source and released under the [MIT License](https://github.com/jbox-web/redmine_pusher_notifications/blob/devel/LICENSE).\r\n\r\nCopyright (c) 2015 Nicolas Rodriguez (nrodriguez@jbox-web.com), JBox Web (http://www.jbox-web.com) [![endorse](https://api.coderwall.com/n-rodriguez/endorsecount.png)](https://coderwall.com/n-rodriguez)\r\n\r\n## Contribute\r\n\r\nYou can contribute to this plugin in many ways such as :\r\n* Helping with documentation\r\n* Contributing code (features or bugfixes)\r\n* Reporting a bug\r\n* Submitting translations\r\n\r\nYou can also donate :)\r\n\r\n[![Donate](https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FBT7E7DAVVEEU)\r\n","google":"UA-36504891-3","note":"Don't delete this file! It's used internally to help with page regeneration."}